<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Manga to Fav</title>
</head>
<body>
    <h1>Add Manga to Fav</h1>
    <form id="AddMangaForm">
        <label for="mangaName">Manga Name:</label>
        <input type="text" id="mangaName" name="mangaName" required><br><br>
        
        <label for="username">Username:</label>
        <input type="text" id="username" name="username" required><br><br>
        
        <button type="submit">Add to Wishlist</button>
    </form>

    <div id="responseMessage"></div>

    <script>
        document.getElementById("AddMangaForm").addEventListener("submit", async function(event) {
            event.preventDefault();
            try {
                const formData = new FormData(this);
                const mangaName = formData.get("mangaName");
                const username = formData.get("username");

                // Send request to server to execute stored procedure
                const response = await fetch('/executeQuery', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        sql: `exec AddMangaTofav @mangaName='${mangaName}', @username='${username}'`
                    })
                });

                if (!response.ok) {
                    throw new Error('Failed to add manga to Fav.');
                }

                const responseData = await response.json();
                console.log(responseData); // Log response for inspection

                if (responseData.success) {
                    document.getElementById("responseMessage").innerText = 'Manga added to Fav successfully.';
                } else {
                    throw new Error('Failed to add manga to Fav.');
                }
            } catch (error) {
                console.error(error);
                document.getElementById("responseMessage").innerText = 'Error: ' + error.message;
            }
        });
    </script>
</body>
</html>
